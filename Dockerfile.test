FROM fedora:28

RUN dnf -y install make libgit2-glib tito python3-pylint  \
                    python3-nose python3-mako python3-flask \
                    python3-coverage libselinux-python3 sudo \
                    pykickstart python3-pytoml python3-sphinx \
                    python3-semantic_version \
                    anaconda-tui python3-gevent beakerlib && \
    useradd weldr

RUN mkdir /lorax
COPY . /lorax
# remove byte-compiled files to avoid issues between Python 2/3
# this can happen when you switch between rhel7 and master branches
RUN find /lorax -name "*.pyc" -exec rm -f {} \;

WORKDIR /lorax
RUN make test
